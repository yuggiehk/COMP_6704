2025-11-18 20:17:38,345 - INFO - Logging initialized for AdaGrad optimizer
2025-11-18 20:17:38,345 - INFO - Log file: /mnt/nvme1/suyuejiao/egohos_split_data/logger/training_AdaGrad_20251118_201738.log
2025-11-18 20:17:38,345 - INFO - Starting training process with AdaGrad optimizer
2025-11-18 20:17:38,345 - INFO - Log file successfully created at specified location: /mnt/nvme1/suyuejiao/egohos_split_data/logger/training_AdaGrad_20251118_201738.log
2025-11-18 20:17:38,401 - INFO - Found 8993 valid image-mask pairs
2025-11-18 20:17:38,408 - INFO - Found 1126 valid image-mask pairs
2025-11-18 20:17:38,408 - INFO - Training samples: 8993
2025-11-18 20:17:38,408 - INFO - Validation samples: 1126
2025-11-18 20:17:38,408 - INFO - Batch size: 8
2025-11-18 20:17:38,408 - INFO - 
============================================================
2025-11-18 20:17:38,408 - INFO - Training with AdaGrad optimizer (Adaptive Gradient Algorithm)
2025-11-18 20:17:38,409 - INFO - ============================================================
2025-11-18 20:17:38,635 - INFO - Using device: cuda
2025-11-18 20:17:38,635 - INFO - Training with AdaGrad optimizer (Adaptive Gradient Algorithm)
2025-11-18 20:17:44,262 - INFO - Starting training with AdaGrad optimizer for 50 epochs
2025-11-18 20:17:44,262 - INFO - Learning rate: 0.01, Weight decay: 1e-4
2025-11-18 20:17:44,262 - INFO - Batch size: 8
2025-11-18 20:17:44,262 - INFO - AdaGrad adapts learning rates per parameter based on historical gradients
2025-11-18 20:17:44,262 - INFO - Note: Higher initial learning rate is often used for AdaGrad
2025-11-18 20:31:30,442 - INFO - [AdaGrad] Saved best model: /mnt/nvme1/suyuejiao/egohos_split_data/ckpt_AdaGrad/best_model.pth
2025-11-18 20:31:30,442 - INFO - [AdaGrad] Best Val IoU: 0.2474, Val Loss: 0.5320
2025-11-18 20:31:30,442 - INFO - [AdaGrad] Epoch 1/50: Train Loss: 0.5604, Val Loss: 0.5320, Val IoU: 0.2474, Val Acc: 0.8552
2025-11-18 20:45:32,518 - INFO - [AdaGrad] Saved best model: /mnt/nvme1/suyuejiao/egohos_split_data/ckpt_AdaGrad/best_model.pth
2025-11-18 20:45:32,519 - INFO - [AdaGrad] Best Val IoU: 0.3330, Val Loss: 0.4115
2025-11-18 20:45:32,519 - INFO - [AdaGrad] Epoch 2/50: Train Loss: 0.4372, Val Loss: 0.4115, Val IoU: 0.3330, Val Acc: 0.8874
2025-11-18 20:59:32,496 - INFO - [AdaGrad] Epoch 3/50: Train Loss: 0.3744, Val Loss: 0.8189, Val IoU: 0.2468, Val Acc: 0.7182
2025-11-18 21:13:33,545 - INFO - [AdaGrad] Epoch 4/50: Train Loss: 0.3430, Val Loss: 1.2640, Val IoU: 0.1507, Val Acc: 0.6306
2025-11-18 21:27:31,754 - INFO - [AdaGrad] Saved best model: /mnt/nvme1/suyuejiao/egohos_split_data/ckpt_AdaGrad/best_model.pth
2025-11-18 21:27:31,754 - INFO - [AdaGrad] Best Val IoU: 0.3338, Val Loss: 0.3958
2025-11-18 21:27:31,754 - INFO - [AdaGrad] Epoch 5/50: Train Loss: 0.3232, Val Loss: 0.3958, Val IoU: 0.3338, Val Acc: 0.8788
2025-11-18 21:41:31,327 - INFO - [AdaGrad] Saved best model: /mnt/nvme1/suyuejiao/egohos_split_data/ckpt_AdaGrad/best_model.pth
2025-11-18 21:41:31,328 - INFO - [AdaGrad] Best Val IoU: 0.3824, Val Loss: 0.3365
2025-11-18 21:41:31,328 - INFO - [AdaGrad] Epoch 6/50: Train Loss: 0.3069, Val Loss: 0.3365, Val IoU: 0.3824, Val Acc: 0.9058
2025-11-18 21:55:26,450 - INFO - [AdaGrad] Epoch 7/50: Train Loss: 0.2939, Val Loss: 0.8754, Val IoU: 0.1524, Val Acc: 0.8377
2025-11-18 22:09:25,581 - INFO - [AdaGrad] Saved best model: /mnt/nvme1/suyuejiao/egohos_split_data/ckpt_AdaGrad/best_model.pth
2025-11-18 22:09:25,581 - INFO - [AdaGrad] Best Val IoU: 0.4017, Val Loss: 0.3198
2025-11-18 22:09:25,581 - INFO - [AdaGrad] Epoch 8/50: Train Loss: 0.2833, Val Loss: 0.3198, Val IoU: 0.4017, Val Acc: 0.9115
2025-11-18 22:23:22,276 - INFO - [AdaGrad] Saved best model: /mnt/nvme1/suyuejiao/egohos_split_data/ckpt_AdaGrad/best_model.pth
2025-11-18 22:23:22,276 - INFO - [AdaGrad] Best Val IoU: 0.4311, Val Loss: 0.3003
2025-11-18 22:23:22,276 - INFO - [AdaGrad] Epoch 9/50: Train Loss: 0.2720, Val Loss: 0.3003, Val IoU: 0.4311, Val Acc: 0.9123
2025-11-18 22:37:20,003 - INFO - [AdaGrad] Epoch 10/50: Train Loss: 0.2621, Val Loss: 0.4868, Val IoU: 0.2615, Val Acc: 0.8688
2025-11-18 22:51:15,884 - INFO - [AdaGrad] Epoch 11/50: Train Loss: 0.2525, Val Loss: 0.3807, Val IoU: 0.3134, Val Acc: 0.8894
2025-11-18 23:05:10,879 - INFO - [AdaGrad] Epoch 12/50: Train Loss: 0.2435, Val Loss: 0.3397, Val IoU: 0.3998, Val Acc: 0.8982
2025-11-18 23:19:11,285 - INFO - [AdaGrad] Saved best model: /mnt/nvme1/suyuejiao/egohos_split_data/ckpt_AdaGrad/best_model.pth
2025-11-18 23:19:11,286 - INFO - [AdaGrad] Best Val IoU: 0.4597, Val Loss: 0.2843
2025-11-18 23:19:11,286 - INFO - [AdaGrad] Epoch 13/50: Train Loss: 0.2352, Val Loss: 0.2843, Val IoU: 0.4597, Val Acc: 0.9189
2025-11-18 23:33:07,010 - INFO - [AdaGrad] Epoch 14/50: Train Loss: 0.2252, Val Loss: 0.3950, Val IoU: 0.3999, Val Acc: 0.8986
2025-11-18 23:47:03,991 - INFO - [AdaGrad] Epoch 15/50: Train Loss: 0.2176, Val Loss: 1.3359, Val IoU: 0.1584, Val Acc: 0.6621
2025-11-19 00:01:00,673 - INFO - [AdaGrad] Saved best model: /mnt/nvme1/suyuejiao/egohos_split_data/ckpt_AdaGrad/best_model.pth
2025-11-19 00:01:00,673 - INFO - [AdaGrad] Best Val IoU: 0.4772, Val Loss: 0.2826
2025-11-19 00:01:00,673 - INFO - [AdaGrad] Epoch 16/50: Train Loss: 0.2103, Val Loss: 0.2826, Val IoU: 0.4772, Val Acc: 0.9191
2025-11-19 00:14:56,454 - INFO - [AdaGrad] Epoch 17/50: Train Loss: 0.1977, Val Loss: 0.3805, Val IoU: 0.4172, Val Acc: 0.9142
2025-11-19 00:28:54,527 - INFO - [AdaGrad] Saved best model: /mnt/nvme1/suyuejiao/egohos_split_data/ckpt_AdaGrad/best_model.pth
2025-11-19 00:28:54,527 - INFO - [AdaGrad] Best Val IoU: 0.5065, Val Loss: 0.2628
2025-11-19 00:28:54,527 - INFO - [AdaGrad] Epoch 18/50: Train Loss: 0.1876, Val Loss: 0.2628, Val IoU: 0.5065, Val Acc: 0.9232
2025-11-19 00:42:49,954 - INFO - [AdaGrad] Epoch 19/50: Train Loss: 0.1763, Val Loss: 0.5592, Val IoU: 0.3480, Val Acc: 0.8704
2025-11-19 00:56:48,409 - INFO - [AdaGrad] Epoch 20/50: Train Loss: 0.1669, Val Loss: 0.5935, Val IoU: 0.3411, Val Acc: 0.8422
2025-11-19 01:10:44,195 - INFO - [AdaGrad] Epoch 21/50: Train Loss: 0.1546, Val Loss: 0.2917, Val IoU: 0.4858, Val Acc: 0.9231
2025-11-19 01:24:39,613 - INFO - [AdaGrad] Epoch 22/50: Train Loss: 0.1427, Val Loss: 0.3254, Val IoU: 0.4736, Val Acc: 0.9221
2025-11-19 01:38:34,959 - INFO - [AdaGrad] Epoch 23/50: Train Loss: 0.1339, Val Loss: 0.2792, Val IoU: 0.4986, Val Acc: 0.9282
2025-11-19 01:52:27,837 - INFO - [AdaGrad] Epoch 24/50: Train Loss: 0.1217, Val Loss: 1.1968, Val IoU: 0.1861, Val Acc: 0.7040
2025-11-19 02:06:24,251 - INFO - [AdaGrad] Epoch 25/50: Train Loss: 0.1007, Val Loss: 0.3849, Val IoU: 0.4296, Val Acc: 0.8985
2025-11-19 02:20:16,212 - INFO - [AdaGrad] Epoch 26/50: Train Loss: 0.0827, Val Loss: 0.3024, Val IoU: 0.5036, Val Acc: 0.9280
2025-11-19 02:34:10,493 - INFO - [AdaGrad] Epoch 27/50: Train Loss: 0.0740, Val Loss: 0.3080, Val IoU: 0.5039, Val Acc: 0.9279
2025-11-19 02:48:07,027 - INFO - [AdaGrad] Epoch 28/50: Train Loss: 0.0693, Val Loss: 0.3799, Val IoU: 0.4593, Val Acc: 0.9129
2025-11-19 03:02:00,824 - INFO - [AdaGrad] Epoch 29/50: Train Loss: 0.0660, Val Loss: 0.3146, Val IoU: 0.5054, Val Acc: 0.9295
2025-11-19 03:15:55,945 - INFO - [AdaGrad] Epoch 30/50: Train Loss: 0.0609, Val Loss: 0.3367, Val IoU: 0.4897, Val Acc: 0.9212
2025-11-19 03:29:51,249 - INFO - [AdaGrad] Saved best model: /mnt/nvme1/suyuejiao/egohos_split_data/ckpt_AdaGrad/best_model.pth
2025-11-19 03:29:51,249 - INFO - [AdaGrad] Best Val IoU: 0.5187, Val Loss: 0.3143
2025-11-19 03:29:51,249 - INFO - [AdaGrad] Epoch 31/50: Train Loss: 0.0524, Val Loss: 0.3143, Val IoU: 0.5187, Val Acc: 0.9295
2025-11-19 03:43:46,563 - INFO - [AdaGrad] Epoch 32/50: Train Loss: 0.0479, Val Loss: 0.3241, Val IoU: 0.5128, Val Acc: 0.9309
2025-11-19 03:57:39,369 - INFO - [AdaGrad] Epoch 33/50: Train Loss: 0.0454, Val Loss: 0.3267, Val IoU: 0.5150, Val Acc: 0.9298
2025-11-19 04:11:33,509 - INFO - [AdaGrad] Epoch 34/50: Train Loss: 0.0435, Val Loss: 0.3350, Val IoU: 0.5132, Val Acc: 0.9296
2025-11-19 04:25:29,201 - INFO - [AdaGrad] Epoch 35/50: Train Loss: 0.0418, Val Loss: 0.5278, Val IoU: 0.3548, Val Acc: 0.8770
2025-11-19 04:39:23,537 - INFO - [AdaGrad] Epoch 36/50: Train Loss: 0.0410, Val Loss: 0.4525, Val IoU: 0.4712, Val Acc: 0.9018
2025-11-19 04:53:17,934 - INFO - [AdaGrad] Saved best model: /mnt/nvme1/suyuejiao/egohos_split_data/ckpt_AdaGrad/best_model.pth
2025-11-19 04:53:17,935 - INFO - [AdaGrad] Best Val IoU: 0.5187, Val Loss: 0.3360
2025-11-19 04:53:17,935 - INFO - [AdaGrad] Epoch 37/50: Train Loss: 0.0404, Val Loss: 0.3360, Val IoU: 0.5187, Val Acc: 0.9297
2025-11-19 05:07:12,110 - INFO - [AdaGrad] Epoch 38/50: Train Loss: 0.0371, Val Loss: 0.3870, Val IoU: 0.4951, Val Acc: 0.9230
2025-11-19 05:19:54,846 - INFO - [AdaGrad] Epoch 39/50: Train Loss: 0.0370, Val Loss: 0.3655, Val IoU: 0.5013, Val Acc: 0.9222
2025-11-19 05:31:37,981 - INFO - [AdaGrad] Epoch 40/50: Train Loss: 0.0356, Val Loss: 0.3435, Val IoU: 0.5142, Val Acc: 0.9271
2025-11-19 05:43:21,806 - INFO - [AdaGrad] Epoch 41/50: Train Loss: 0.0346, Val Loss: 0.3418, Val IoU: 0.5164, Val Acc: 0.9276
2025-11-19 05:54:52,116 - INFO - [AdaGrad] Epoch 42/50: Train Loss: 0.0337, Val Loss: 0.3472, Val IoU: 0.5084, Val Acc: 0.9286
2025-11-19 06:03:44,948 - INFO - [AdaGrad] Epoch 43/50: Train Loss: 0.0327, Val Loss: 0.3467, Val IoU: 0.5168, Val Acc: 0.9300
2025-11-19 06:10:58,459 - INFO - [AdaGrad] Epoch 44/50: Train Loss: 0.0321, Val Loss: 0.3501, Val IoU: 0.5171, Val Acc: 0.9301
2025-11-19 06:18:16,401 - INFO - [AdaGrad] Epoch 45/50: Train Loss: 0.0315, Val Loss: 0.3527, Val IoU: 0.5172, Val Acc: 0.9299
2025-11-19 06:25:34,771 - INFO - [AdaGrad] Saved best model: /mnt/nvme1/suyuejiao/egohos_split_data/ckpt_AdaGrad/best_model.pth
2025-11-19 06:25:34,771 - INFO - [AdaGrad] Best Val IoU: 0.5188, Val Loss: 0.3496
2025-11-19 06:25:34,771 - INFO - [AdaGrad] Epoch 46/50: Train Loss: 0.0312, Val Loss: 0.3496, Val IoU: 0.5188, Val Acc: 0.9303
2025-11-19 06:32:47,860 - INFO - [AdaGrad] Epoch 47/50: Train Loss: 0.0307, Val Loss: 0.3556, Val IoU: 0.5128, Val Acc: 0.9306
2025-11-19 06:40:06,602 - INFO - [AdaGrad] Epoch 48/50: Train Loss: 0.0304, Val Loss: 0.3514, Val IoU: 0.5166, Val Acc: 0.9303
2025-11-19 06:47:23,304 - INFO - [AdaGrad] Epoch 49/50: Train Loss: 0.0304, Val Loss: 0.3863, Val IoU: 0.5120, Val Acc: 0.9306
2025-11-19 06:53:33,758 - INFO - [AdaGrad] Epoch 50/50: Train Loss: 0.0298, Val Loss: 0.3524, Val IoU: 0.5171, Val Acc: 0.9294
2025-11-19 06:53:33,758 - INFO - [AdaGrad] Training completed. Best validation IoU: 0.5188
2025-11-19 06:53:36,338 - INFO - Saved training curves: /mnt/nvme1/suyuejiao/egohos_split_data/image/adagrad_training_curves.png
2025-11-19 06:53:36,340 - INFO - Saved training results to: /mnt/nvme1/suyuejiao/egohos_split_data/image/adagrad_training_results.json
2025-11-19 06:53:36,340 - INFO - 
================================================================================
2025-11-19 06:53:36,340 - INFO - Final Training Results (AdaGrad Optimizer):
2025-11-19 06:53:36,340 - INFO - ================================================================================
2025-11-19 06:53:36,340 - INFO - Final Validation IoU: 0.5171
2025-11-19 06:53:36,340 - INFO - Final Validation Accuracy: 0.9294
2025-11-19 06:53:36,340 - INFO - Final Validation Loss: 0.3524
2025-11-19 06:53:36,340 - INFO - ================================================================================
2025-11-19 06:53:36,341 - INFO - 
Training with AdaGrad optimizer completed! All results saved.
